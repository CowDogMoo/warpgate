# WarpGate/blueprint

The `blueprint` package is a part of the WarpGate.

---

## Table of contents

- [Functions](#functions)
- [Installation](#installation)
- [Usage](#usage)
- [Tests](#tests)
- [Contributing](#contributing)
- [License](#license)

---

## Functions

### Blueprint.BuildImageAttempt(int, string)

```go
BuildImageAttempt(int, string) []packer.ImageHash, string, error
```

BuildImageAttempt attempts to build the image for the blueprint.

**Parameters:**

attempt: The attempt number for the build.
bucketName: The name of the S3 bucket.

**Returns:**

[]packer.ImageHash: The image hashes generated by the build.
string: The AMI ID if one was built.
error: An error if any issue occurs during the build process.

---

### Blueprint.BuildPackerImages()

```go
BuildPackerImages() map[string]string, error
```

BuildPackerImages builds packer images concurrently.

**Returns:**

map[string]string: A map of image hashes generated by the build process.
error: An error if any issue occurs during the build process.

---

### Blueprint.CreateBuildDir()

```go
CreateBuildDir() error
```

CreateBuildDir creates a temporary build directory and copies the repo into it.

**Returns:**

error: An error if the build directory creation or repo copy fails.

---

### Blueprint.Initialize()

```go
Initialize() error
```

Initialize initializes the blueprint by setting up the necessary packer templates.

**Returns:**

error: An error if the initialization fails.

---

### Blueprint.LoadPackerTemplates(string)

```go
LoadPackerTemplates(string) error
```

LoadPackerTemplates loads Packer templates from the blueprint.

**Returns:**

error: An error if any issue occurs while loading the Packer templates.

---

### Blueprint.ManageS3Bucket(*cloudstorage.CloudStorage, string)

```go
ManageS3Bucket(*cloudstorage.CloudStorage, string) error
```

ManageS3Bucket manages the lifecycle of the S3 bucket for the blueprint.

**Parameters:**

cs: CloudStorage configuration.
action: The action to perform, either "create" or "destroy".

**Returns:**

error: An error if the S3 bucket management fails.

---

### Blueprint.ParseCommandLineFlags(*cobra.Command)

```go
ParseCommandLineFlags(*cobra.Command) error
```

ParseCommandLineFlags parses command line flags for a Blueprint.

**Parameters:**

cmd: A Cobra command object containing flags and arguments for the command.

**Returns:**

error: An error if any issue occurs while parsing the command line flags.

---

### Blueprint.PreparePackerArgs(string, bool)

```go
PreparePackerArgs(string, bool) []string
```

PreparePackerArgs prepares the arguments for the packer build command.

**Parameters:**

bucketName: The name of the S3 bucket.
noAMI: Whether to skip building AMI images.
noContainers: Whether to skip building container images.

**Returns:**

[]string: A slice of arguments for the packer build command.

---

### Blueprint.SetConfigPath()

```go
SetConfigPath() error
```

SetConfigPath sets the configuration path for a Blueprint.

**Returns:**

error: An error if the configuration path cannot be set.

---

### Blueprint.ValidatePackerTemplates()

```go
ValidatePackerTemplates() error
```

ValidatePackerTemplate validates the Packer template for the blueprint.

**Returns:**

error: An error if the Packer template is invalid.

---

## Installation

To use the WarpGate/blueprint package, you first need to install it.
Follow the steps below to install via go install.

```bash
go install github.com/cowdogmoo/warpgate/blueprint@latest
```

---

## Usage

After installation, you can import the package in your Go project
using the following import statement:

```go
import "github.com/cowdogmoo/warpgate/blueprint"
```

---

## Tests

To ensure the package is working correctly, run the following
command to execute the tests for `WarpGate/blueprint`:

```bash
go test -v
```

---

## Contributing

Pull requests are welcome. For major changes,
please open an issue first to discuss what
you would like to change.

---

## License

This project is licensed under the MIT
License - see the [LICENSE](https://github.com/CowDogMoo/WarpGate/blob/main/LICENSE)
file for details.
